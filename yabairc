#!/usr/bin/env bash
yabai -m rule --add app="iTerm" space=1

# float some apps

yabai -m rule --add app="^Emacs$" manage=off
yabai -m rule --add app="^Emacs$" title="^$" layer=above manage=off # don't manage popups
yabai -m rule --add app="^Slack" manage=on
yabai -m rule --add app="^Ãœbersicht$" manage=off
yabai -m rule --add app="^CloudApp$" manage=off
yabai -m rule --add app="^App Store$" manage=off
yabai -m rule --add app="^Microsoft" manage=off # Teams, Outlook
yabai -m rule --add app="^Install" manage=off
yabai -m rule --add app="^Dictionary" manage=off
yabai -m rule --add app="^System" manage=off
yabai -m rule --add app="^Problem Report" manage=off
yabai -m rule --add app="IntelliJ IDEA" manage=off
yabai -m rule --add app="^Google Chrome$" title="^Picture in Picture$" manage=on
# show digital colour meter topmost and on all spaces
# sticky doesnt work without more liberal yabai scripting than you enabled..
yabai -m rule --add app="^Digital Colou?r Meter$" sticky=on layer=above manage=off

# make space switching work without disabling sip
yabai -m config mouse_follows_focus off
yabai -m config focus_follows_mouse off

# move and resize with mouse
# TODO torgeir cmd stjeler cmd+click i chrome...
#yabai -m config mouse_modifier alt
#yabai -m config mouse_action1 move
#yabai -m config mouse_action2 resize

# set layout
yabai -m config layout bsp

# floating windows are topmost
yabai -m config window_topmost on

# yabai -m config auto_balance

yabai -m config top_padding    0
yabai -m config right_padding  0
yabai -m config bottom_padding 0
yabai -m config left_padding   0
yabai -m config window_gap     0

# # simple bar refresh
#yabai -m signal --add event=space_changed action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-spaces-jsx\"'"
#yabai -m signal --add event=display_changed action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-spaces-jsx\"'"
#yabai -m signal --add event=window_resized action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-spaces-jsx\"'"
#yabai -m signal --add event=space_changed action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-process-jsx\"'"
#
#yabai -m signal --add event=window_focused action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-process-jsx\"'"
#yabai -m signal --add event=window_focused action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-spaces-jsx\"'"
#
#yabai -m signal --add event=application_front_switched action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-process-jsx\"'"
#yabai -m signal --add event=application_front_switched action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-spaces-jsx\"'"
#
#yabai -m signal --add event=window_destroyed action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-process-jsx\"'"
#yabai -m signal --add event=window_destroyed action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-spaces-jsx\"'"
#yabai -m signal --add event=window_title_changed action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-process-jsx\"'"
